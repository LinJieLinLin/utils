<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>microApi.js - lj-utils</title>
    
    <meta name="description" content="A clean, responsive documentation template theme for JSDoc 3." />
    
        <meta name="keywords" content="jsdoc, docdash,lj-utils" />
        <meta name="keyword" content="jsdoc, docdash,lj-utils" />
    
    
    
    <meta property="og:title" content="Docdash"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://cloud.githubusercontent.com/assets/447956/13398144/4dde7f36-defd-11e5-8909-1a9013302cb9.png"/>
    <meta property="og:site_name" content="Docdash"/>
    <meta property="og:url" content="http://clenemt.github.io/docdash/"/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/LinJieLinLin/utils" target="_blank" class="menu-item" id="Github" >Github repo</a></h2><h2><a href="https://gitee.com/uni-pro/utils" target="_blank" class="menu-item" id="Gitee" >Gitee repo</a></h2><h2><a href="../coverage/index.html" target="_blank" class="menu-item" id="coverage" >coverage</a></h2><h3>Classes</h3><ul><li><a href="CanvasClass_CanvasClass.html">CanvasClass#CanvasClass</a></li><li><a href="Counter.html">Counter</a><ul class='methods'><li data-type='method'><a href="Counter.html#setCount">setCount</a></li><li data-type='method'><a href="Counter.html#setMaxCount">setMaxCount</a></li><li data-type='method'><a href="Counter.html#start">start</a></li><li data-type='method'><a href="Counter.html#stop">stop</a></li></ul></li><li><a href="Debounce.html">Debounce</a><ul class='methods'><li data-type='method'><a href="Debounce.html#debounce">debounce</a></li></ul></li><li><a href="Loading.html">Loading</a><ul class='methods'><li data-type='method'><a href="Loading.html#hide">hide</a></li><li data-type='method'><a href="Loading.html#loading">loading</a></li><li data-type='method'><a href="Loading.html#show">show</a></li></ul></li><li><a href="Throttle.html">Throttle</a><ul class='methods'><li data-type='method'><a href="Throttle.html#throttle">throttle</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-directive.html">directive</a><ul class='members'><li data-type='member'><a href="module-directive.html#.scrollX">scrollX</a></li></ul></li><li><a href="module-encrypt_base64.html">encrypt/base64</a><ul class='methods'><li data-type='method'><a href="module-encrypt_base64.html#.deBase64">deBase64</a></li><li data-type='method'><a href="module-encrypt_base64.html#.decode">decode</a></li><li data-type='method'><a href="module-encrypt_base64.html#.enBase64">enBase64</a></li><li data-type='method'><a href="module-encrypt_base64.html#.encode">encode</a></li></ul></li><li><a href="module-encrypt_crypto.html">encrypt/crypto</a><ul class='methods'><li data-type='method'><a href="module-encrypt_crypto.html#.aesInit">aesInit</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.deAes">deAes</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.deBase64">deBase64</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.decode">decode</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.enAes">enAes</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.enBase64">enBase64</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.encode">encode</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.md5">md5</a></li></ul></li><li><a href="module-index.html">index</a><ul class='methods'><li data-type='method'><a href="module-index.html#.blobToBase64">blobToBase64</a></li><li data-type='method'><a href="module-index.html#.blobToFile">blobToFile</a></li><li data-type='method'><a href="module-index.html#.blobUrlToFile">blobUrlToFile</a></li><li data-type='method'><a href="module-index.html#.dataURLtoBlob">dataURLtoBlob</a></li><li data-type='method'><a href="module-index.html#.decodeHtml">decodeHtml</a></li><li data-type='method'><a href="module-index.html#.deepCopy">deepCopy</a></li><li data-type='method'><a href="module-index.html#.delCookie">delCookie</a></li><li data-type='method'><a href="module-index.html#.dlFile">dlFile</a></li><li data-type='method'><a href="module-index.html#.encodeHtml">encodeHtml</a></li><li data-type='method'><a href="module-index.html#.formatNumber">formatNumber</a></li><li data-type='method'><a href="module-index.html#.formatSize">formatSize</a></li><li data-type='method'><a href="module-index.html#.formatTime">formatTime</a></li><li data-type='method'><a href="module-index.html#.friendlyTime">friendlyTime</a></li><li data-type='method'><a href="module-index.html#.getCookie">getCookie</a></li><li data-type='method'><a href="module-index.html#.getDuration">getDuration</a></li><li data-type='method'><a href="module-index.html#.getEnv">getEnv</a></li><li data-type='method'><a href="module-index.html#.getInfo">getInfo</a></li><li data-type='method'><a href="module-index.html#.getNetworkStatus">getNetworkStatus</a></li><li data-type='method'><a href="module-index.html#.getObj">getObj</a></li><li data-type='method'><a href="module-index.html#.getRandomColor">getRandomColor</a></li><li data-type='method'><a href="module-index.html#.getRegexp">getRegexp</a></li><li data-type='method'><a href="module-index.html#.getStorage">getStorage</a></li><li data-type='method'><a href="module-index.html#.getUrlParam">getUrlParam</a></li><li data-type='method'><a href="module-index.html#.getUrlParamObj">getUrlParamObj</a></li><li data-type='method'><a href="module-index.html#.getUuid">getUuid</a></li><li data-type='method'><a href="module-index.html#.hideInfo">hideInfo</a></li><li data-type='method'><a href="module-index.html#.isBlob">isBlob</a></li><li data-type='method'><a href="module-index.html#.isFile">isFile</a></li><li data-type='method'><a href="module-index.html#.isIdCard">isIdCard</a></li><li data-type='method'><a href="module-index.html#.isJson">isJson</a></li><li data-type='method'><a href="module-index.html#.isPrime">isPrime</a></li><li data-type='method'><a href="module-index.html#.loadFile">loadFile</a></li><li data-type='method'><a href="module-index.html#.px2vw">px2vw</a></li><li data-type='method'><a href="module-index.html#.randomInt">randomInt</a></li><li data-type='method'><a href="module-index.html#.remInit">remInit</a></li><li data-type='method'><a href="module-index.html#.replaceUrlParam">replaceUrlParam</a></li><li data-type='method'><a href="module-index.html#.rmbPrice">rmbPrice</a></li><li data-type='method'><a href="module-index.html#.safe">safe</a></li><li data-type='method'><a href="module-index.html#.safeData">safeData</a></li><li data-type='method'><a href="module-index.html#.secondToTime">secondToTime</a></li><li data-type='method'><a href="module-index.html#.setCookie">setCookie</a></li><li data-type='method'><a href="module-index.html#.setEnv">setEnv</a></li><li data-type='method'><a href="module-index.html#.setLog">setLog</a></li><li data-type='method'><a href="module-index.html#.setObj">setObj</a></li><li data-type='method'><a href="module-index.html#.setStorage">setStorage</a></li><li data-type='method'><a href="module-index.html#.setTitle">setTitle</a></li><li data-type='method'><a href="module-index.html#.setUrlParams">setUrlParams</a></li><li data-type='method'><a href="module-index.html#.sleep">sleep</a></li><li data-type='method'><a href="module-index.html#.string10to62">string10to62</a></li><li data-type='method'><a href="module-index.html#.string62to10">string62to10</a></li><li data-type='method'><a href="module-index.html#.toFixed">toFixed</a></li><li data-type='method'><a href="module-index.html#.toHump">toHump</a></li><li data-type='method'><a href="module-index.html#.toLine">toLine</a></li><li data-type='method'><a href="module-index.html#.toList">toList</a></li><li data-type='method'><a href="module-index.html#~autoPlayAudio">autoPlayAudio</a></li><li data-type='method'><a href="module-index.html#~blobToBase64">blobToBase64</a></li><li data-type='method'><a href="module-index.html#~blobToFile">blobToFile</a></li><li data-type='method'><a href="module-index.html#~blobUrlToFile">blobUrlToFile</a></li><li data-type='method'><a href="module-index.html#~dataURLtoBlob">dataURLtoBlob</a></li><li data-type='method'><a href="module-index.html#~decodeHtml">decodeHtml</a></li><li data-type='method'><a href="module-index.html#~deepCopy">deepCopy</a></li><li data-type='method'><a href="module-index.html#~delCookie">delCookie</a></li><li data-type='method'><a href="module-index.html#~dlFile">dlFile</a></li><li data-type='method'><a href="module-index.html#~encodeHtml">encodeHtml</a></li><li data-type='method'><a href="module-index.html#~formatNumber">formatNumber</a></li><li data-type='method'><a href="module-index.html#~formatSize">formatSize</a></li><li data-type='method'><a href="module-index.html#~formatTime">formatTime</a></li><li data-type='method'><a href="module-index.html#~friendlyTime">friendlyTime</a></li><li data-type='method'><a href="module-index.html#~getCookie">getCookie</a></li><li data-type='method'><a href="module-index.html#~getDuration">getDuration</a></li><li data-type='method'><a href="module-index.html#~getEnv">getEnv</a></li><li data-type='method'><a href="module-index.html#~getInfo">getInfo</a></li><li data-type='method'><a href="module-index.html#~getNetworkStatus">getNetworkStatus</a></li><li data-type='method'><a href="module-index.html#~getObj">getObj</a></li><li data-type='method'><a href="module-index.html#~getRandomColor">getRandomColor</a></li><li data-type='method'><a href="module-index.html#~getRegexp">getRegexp</a></li><li data-type='method'><a href="module-index.html#~getStorage">getStorage</a></li><li data-type='method'><a href="module-index.html#~getUrlParam">getUrlParam</a></li><li data-type='method'><a href="module-index.html#~getUrlParamObj">getUrlParamObj</a></li><li data-type='method'><a href="module-index.html#~getUuid">getUuid</a></li><li data-type='method'><a href="module-index.html#~hideInfo">hideInfo</a></li><li data-type='method'><a href="module-index.html#~isBlob">isBlob</a></li><li data-type='method'><a href="module-index.html#~isFile">isFile</a></li><li data-type='method'><a href="module-index.html#~isIdCard">isIdCard</a></li><li data-type='method'><a href="module-index.html#~isJson">isJson</a></li><li data-type='method'><a href="module-index.html#~isPrime">isPrime</a></li><li data-type='method'><a href="module-index.html#~loadFile">loadFile</a></li><li data-type='method'><a href="module-index.html#~px2vw">px2vw</a></li><li data-type='method'><a href="module-index.html#~randomInt">randomInt</a></li><li data-type='method'><a href="module-index.html#~remInit">remInit</a></li><li data-type='method'><a href="module-index.html#~replaceUrlParam">replaceUrlParam</a></li><li data-type='method'><a href="module-index.html#~requestDeviceMotionPermission">requestDeviceMotionPermission</a></li><li data-type='method'><a href="module-index.html#~rmbPrice">rmbPrice</a></li><li data-type='method'><a href="module-index.html#~safe">safe</a></li><li data-type='method'><a href="module-index.html#~safeData">safeData</a></li><li data-type='method'><a href="module-index.html#~secondToTime">secondToTime</a></li><li data-type='method'><a href="module-index.html#~setCookie">setCookie</a></li><li data-type='method'><a href="module-index.html#~setEnv">setEnv</a></li><li data-type='method'><a href="module-index.html#~setLog">setLog</a></li><li data-type='method'><a href="module-index.html#~setObj">setObj</a></li><li data-type='method'><a href="module-index.html#~setStorage">setStorage</a></li><li data-type='method'><a href="module-index.html#~setTitle">setTitle</a></li><li data-type='method'><a href="module-index.html#~setUrlParams">setUrlParams</a></li><li data-type='method'><a href="module-index.html#~sleep">sleep</a></li><li data-type='method'><a href="module-index.html#~string10to62">string10to62</a></li><li data-type='method'><a href="module-index.html#~string62to10">string62to10</a></li><li data-type='method'><a href="module-index.html#~toFixed">toFixed</a></li><li data-type='method'><a href="module-index.html#~toHump">toHump</a></li><li data-type='method'><a href="module-index.html#~toLine">toLine</a></li><li data-type='method'><a href="module-index.html#~toList">toList</a></li></ul></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li><a href="module-microApi.html">microApi</a><ul class='members'><li data-type='member'><a href="module-microApi.html#.APP">APP</a></li><li data-type='member'><a href="module-microApi.html#.IS_H5">IS_H5</a></li><li data-type='member'><a href="module-microApi.html#~interceptors">interceptors</a></li></ul><ul class='methods'><li data-type='method'><a href="module-microApi.html#.checkSetting">checkSetting</a></li><li data-type='method'><a href="module-microApi.html#.checkUpdate">checkUpdate</a></li><li data-type='method'><a href="module-microApi.html#.clearStorageSync">clearStorageSync</a></li><li data-type='method'><a href="module-microApi.html#.cloudApi">cloudApi</a></li><li data-type='method'><a href="module-microApi.html#.downloadImgs">downloadImgs</a></li><li data-type='method'><a href="module-microApi.html#.getCurrentPage">getCurrentPage</a></li><li data-type='method'><a href="module-microApi.html#.getCurrentPageUrl">getCurrentPageUrl</a></li><li data-type='method'><a href="module-microApi.html#.getDb">getDb</a></li><li data-type='method'><a href="module-microApi.html#.getDom">getDom</a></li><li data-type='method'><a href="module-microApi.html#.getLocation">getLocation</a></li><li data-type='method'><a href="module-microApi.html#.getRichText">getRichText</a></li><li data-type='method'><a href="module-microApi.html#.getStorage">getStorage</a></li><li data-type='method'><a href="module-microApi.html#.getStorageSync">getStorageSync</a></li><li data-type='method'><a href="module-microApi.html#.getSystemInfo">getSystemInfo</a></li><li data-type='method'><a href="module-microApi.html#.getUserInfo">getUserInfo</a></li><li data-type='method'><a href="module-microApi.html#.hideLoading">hideLoading</a></li><li data-type='method'><a href="module-microApi.html#.init">init</a></li><li data-type='method'><a href="module-microApi.html#.ljApiFn">ljApiFn</a></li><li data-type='method'><a href="module-microApi.html#.login">login</a></li><li data-type='method'><a href="module-microApi.html#.P">P</a></li><li data-type='method'><a href="module-microApi.html#.refresh">refresh</a></li><li data-type='method'><a href="module-microApi.html#.request">request</a></li><li data-type='method'><a href="module-microApi.html#.requestCloud">requestCloud</a></li><li data-type='method'><a href="module-microApi.html#.scrollTop">scrollTop</a></li><li data-type='method'><a href="module-microApi.html#.setRequest">setRequest</a></li><li data-type='method'><a href="module-microApi.html#.setStorage">setStorage</a></li><li data-type='method'><a href="module-microApi.html#.setTitle">setTitle</a></li><li data-type='method'><a href="module-microApi.html#.showLoading">showLoading</a></li><li data-type='method'><a href="module-microApi.html#.toast">toast</a></li><li data-type='method'><a href="module-microApi.html#.toPage">toPage</a></li><li data-type='method'><a href="module-microApi.html#.uploadImg">uploadImg</a></li><li data-type='method'><a href="module-microApi.html#.uploadImgs">uploadImgs</a></li><li data-type='method'><a href="module-microApi.html#.wxLog">wxLog</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">microApi.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module
 * @author linjielinlin 993353454@qq.com
 * @date 2022-05-22 00:41:33
 * @description 微信小程序/uniapp/taro公共函数
 */
var __awaiter = (this &amp;&amp; this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
/* eslint-disable no-constant-condition,no-undef */
import Loading from './class/Loading';
import Throttle from './class/Throttle';
import { decode, encode } from './encrypt/base64';
import { isJson, safeData, setUrlParams, blobToFile, dataURLtoBlob, sleep, } from './index';
import { getEnv, getUrlParamObj, getInfo } from './base';
let app = {};
let appConfig = {
    localEncrypt: false,
};
let isH5 = false;
// #ifdef  H5
isH5 = true;
// #endif
let ljCloud = {};
if (typeof uni !== 'undefined') {
    app = uni;
}
else if (typeof taro !== 'undefined') {
    app = taro;
}
else if (typeof wx !== 'undefined') {
    app = wx;
}
// 初始化loading
const L = new Loading(() => {
    app.showLoading({
        mask: true,
    });
}, app.hideLoading);
// 函数节流
const throttle = new Throttle();
/**
 * @description 默认拦截函数obj
 */
const interceptors = {
    request(argData) {
        L.loading(1);
        return argData;
    },
    response(argData) {
        return __awaiter(this, void 0, void 0, function* () {
            L.loading();
            return argData;
        });
    },
};
/**
 * @description 初始化配置(uniCloud/request拦截)
 * @function
 * @param {any} argConfig
 * @param {boolean} argConfig.localEncrypt 本地缓存是否加密
 */
export const init = (argConfig) => {
    var _a;
    console.debug('argConfig', argConfig);
    Object.assign(appConfig, argConfig);
    // 初始化uniCloud
    if (typeof uniCloud !== 'undefined' &amp;&amp; ((_a = appConfig === null || appConfig === void 0 ? void 0 : appConfig.uniCloud) === null || _a === void 0 ? void 0 : _a.clientSecret)) {
        ljCloud = uniCloud.init(appConfig.uniCloud);
        console.debug('ljCloud:', ljCloud);
    }
    // 初始化拦截器
    if ((argConfig === null || argConfig === void 0 ? void 0 : argConfig.requestCb) &amp;&amp; (argConfig === null || argConfig === void 0 ? void 0 : argConfig.responseCb)) {
        setRequest(argConfig === null || argConfig === void 0 ? void 0 : argConfig.requestCb, argConfig === null || argConfig === void 0 ? void 0 : argConfig.responseCb);
    }
};
/**
 * @description 获取unicloud DB,返回实例
 * @function
 */
export const getDb = () => {
    if (ljCloud.database) {
        return ljCloud.database();
    }
    else {
        console.debug('ljCloud.database() is undefined');
        return {};
    }
};
/**
 * @description 显示loading
 * @function
 */
export const showLoading = () => {
    L.loading(1);
};
/**
 * @description 隐藏loading
 * @function
 */
export const hideLoading = () => {
    L.loading();
};
/**
 * @description 修改设置拦截函数
 * @function
 * @param {function} argRequest 请求拦截
 * @param {function} argResponse 响应拦截
 */
export const setRequest = (argRequest, argResponse) => {
    if (typeof argRequest === 'function') {
        interceptors.request = (argData) => {
            L.loading(1);
            return argRequest(argData);
        };
    }
    if (typeof argResponse === 'function') {
        interceptors.response = (argData) => {
            L.loading();
            return argResponse(argData);
        };
    }
};
/**
 * @description 使用ljapi
 * @function
 * @param {AnyObject} argOption 传入参数
 * @returns {argOption} 返回修改后的参数
 */
export const ljApiFn = (argOption) => {
    argOption.params = Object.assign({
        path: argOption.url,
        data: safeData(argOption, 'params.data', {}),
    }, JSON.parse(getEnv('VUE_APP_LJAPIC')));
    argOption.params.type = getEnv('VUE_APP_LJAPITYPE');
    argOption.url = getEnv('VUE_APP_LJAPIURL');
    // argOption.method = 'GET'
    argOption.method = 'POST';
    return argOption;
};
/**
 * @description 封装小程序request
 * @function
 * @param {AnyObject} argOption http配置
 * @param {Bool} argIsMock 是否使用mock
 * @returns {promise}
 */
export const request = (argOption, argIsMock = false) => __awaiter(void 0, void 0, void 0, function* () {
    let apiUrl = argOption.url;
    if (getEnv('VUE_APP_LJAPITYPE') === 'get' || argIsMock) {
        argOption = ljApiFn(argOption);
    }
    else {
        argOption = (yield interceptors.request(argOption));
    }
    return new Promise((resolve, reject) => {
        const config = {
            url: argOption.url,
            method: argOption.method || 'GET',
            data: argOption.params,
            success(res = { data: {} }) {
                console.debug('response：', res);
                if (!argIsMock &amp;&amp; getEnv('VUE_APP_LJAPITYPE') === 'set') {
                    argOption.url = apiUrl;
                    argOption.params.data = JSON.stringify(res.data);
                    request(argOption, 1);
                }
                res.config = argOption.config || {};
                return resolve(interceptors.response(res));
            },
            fail(err) {
                return reject(interceptors.response(err));
            },
        };
        Object.assign(config, argOption.config);
        app.request(config);
    });
});
/**
 * @description 图片上传 单图/多图
 * @function
 * @param {object} argOption 参数配置
 * @returns {promise} 上传回调
 */
export const uploadImg = (argOption) => __awaiter(void 0, void 0, void 0, function* () {
    var error, filePath;
    argOption.config = argOption.config || {};
    var data = {
        url: argOption.params.url,
        filePath: '',
        name: argOption.params.name || 'file',
        formData: null,
        header: argOption.config.header || {},
    };
    filePath = argOption.params.filePath;
    const uploadOne = (argPath) => __awaiter(void 0, void 0, void 0, function* () {
        data.filePath = argPath;
        let res = yield P('uploadFile', data).catch((err) => {
            error = err;
        });
        // #ifdef  H5
        URL.revokeObjectURL(argPath);
        // #endif
        if (res) {
            res.data = JSON.parse(res.data);
            return interceptors.response(res);
        }
        else {
            return Promise.reject(error);
        }
    });
    delete argOption.params.url;
    delete argOption.params.filePath;
    delete argOption.params.name;
    delete argOption.config.header['content-type'];
    argOption = interceptors.request(argOption);
    data.formData = argOption.params;
    data.header = argOption.config.header || {};
    // 单张上传
    if (typeof filePath === 'string') {
        return uploadOne(filePath);
    }
    else {
        const temUploadFn = filePath.map(uploadOne);
        let res = yield Promise.all(temUploadFn).catch((err) => {
            error = err;
        });
        if (res) {
            return res;
        }
        else {
            return Promise.reject(error);
        }
    }
});
/**
 * @function
 * @description 请求云函数
 * @param {object} argOption
 * @param {string} argOption.name 云函数名
 * @param {object} argOption.params 参数
 * @param {object} argOption.config 请求配置
 * }
 */
export const requestCloud = (argOption) => __awaiter(void 0, void 0, void 0, function* () {
    argOption = interceptors.request(argOption);
    let e;
    let res = yield ljCloud
        .callFunction({
        name: argOption.name,
        data: argOption.params,
    })
        .catch((err) => {
        e = err;
    });
    if (!res) {
        res = e;
    }
    res.config = argOption.config || {};
    return interceptors.response(res);
});
/**
 * @function
 * @description 检查是否有更新
 */
export const checkUpdate = () => {
    console.debug('checking update');
    if (!safeData(app, 'getUpdateManager')) {
        return;
    }
    const updateManager = app.getUpdateManager();
    updateManager.onUpdateReady(function () {
        app.showModal({
            title: '更新提示',
            content: '新版本已经准备好，是否重启应用？',
            success: function (res) {
                if (res.confirm) {
                    // 新的版本已经下载好，调用 applyUpdate 应用新版本并重启
                    updateManager.applyUpdate();
                }
            },
        });
    });
};
/**
 * @function
 * @description 检查用户授权状态，未授权弹出授权，(userInfo除外)，将拿到的权限放在authSetting 中
 * @param {string} argSet 要检查的权限,userInfo时：已授权会返回userInfo数据
 * @returns {promise}
 */
export const checkSetting = (argSet) => {
    app.removeStorage({
        key: 'authSetting',
    });
    return new Promise(function (resolve, reject) {
        app.getSetting({
            success(res) {
                app.setStorageSync('authSetting', res.authSetting);
                if (!res.authSetting['scope.' + argSet]) {
                    if (argSet === 'userInfo') {
                        return reject(new Error('未授权用户信息'));
                    }
                    app.authorize({
                        scope: 'scope.' + argSet,
                        success(rs) {
                            return resolve(rs);
                        },
                        fail(err) {
                            return reject(err);
                        },
                    });
                }
                else {
                    if (argSet === 'userInfo') {
                        app.getUserInfo({
                            success: (res) => {
                                return resolve(res);
                            },
                            fail: (err) => {
                                return reject(err);
                            },
                        });
                    }
                    else {
                        return resolve(res);
                    }
                }
            },
            fail(err) {
                return reject(err);
            },
        });
    });
};
/**
 * @description 获取地理位置 (类型，)
 * @function
 * @param {string} argType 类型
 * @param {boolean} argAltitude 是否高精度
 * @returns {promise}
 */
export const getLocation = (argType = 'gcj02', argAltitude = false) => {
    const location = () => {
        return new Promise(function (resolve, reject) {
            app.getLocation({
                altitude: argAltitude,
                type: argType,
                success: (res) => {
                    return resolve(res);
                },
                fail: (err) => {
                    return reject(err);
                },
            });
        });
    };
    const re = () => __awaiter(void 0, void 0, void 0, function* () {
        try {
            yield checkSetting('userLocation');
            const re = yield location();
            return re;
        }
        catch (err) {
            if (typeof err === 'object' &amp;&amp; err.errMsg) {
                app.show({
                    title: '您已拒绝地理位置授权,可以在设置中重新打开',
                    icon: 'none',
                });
            }
            return Promise.reject(err);
        }
    });
    return re();
};
/**
 * @description 回到顶部/某个位置
 * @function
 * @param {number} scrollTop 滚动距离
 * @param {number} duration 时间
 * @param {any} ...arg 其他参数selector/offsetTop/success/fail/complete
 * @returns {promise}
 */
export const scrollTop = (scrollTop = 0, duration = 0, ...arg) => {
    return P('pageScrollTo', Object.assign({ scrollTop: scrollTop, duration: duration }, arg));
};
/**
 * @description toast默认为文字提示,默认推迟320ms显示
 * @function
 * @param {string} argTitle title
 * @param {object} argOption 配置
 * argOption.icon:'图标',
 * argOption.delay: '延时显示ms'
 * argOption.duration："显示时间"
 * @returns {promise}
 */
export const toast = (argTitle, argOption = {
    icon: 'none',
    delay: 0,
    duration: 1500,
}) => __awaiter(void 0, void 0, void 0, function* () {
    argOption.title = argTitle;
    if (argOption.delay) {
        yield sleep(argOption.delay);
    }
    hideLoading();
    return P('showToast', argOption);
});
/**
 * @function
 * @description 设置标题
 * @param  {string} argTitle 标题
 */
export const setTitle = (argTitle) => {
    app.setNavigationBarTitle &amp;&amp;
        app.setNavigationBarTitle({
            title: argTitle,
        });
};
/**
 * @function
 * @description uniapp跳到特定页面
 * @param  {string} argPage 标题
 * @param  {object} argParams url参数
 * @param  {string|number} argType 跳转类型 switchTab reload redirectTo reLaunch navigateTo
 * @param {boolean} argForce 是否取消节流非H5生效
 */
export const toPage = (argPage = '', argParams = {}, argType = '', argForce = false) => {
    const toPageFn = () => {
        console.debug('toPage params:', argPage, argParams, argType, argForce);
        // 后退处理
        let pages = (typeof getCurrentPages !== 'undefined' &amp;&amp; getCurrentPages()) || [];
        if (!argPage || argPage === 'back') {
            if (isH5) {
                window.history.go(+('-' + (argType || 1)));
            }
            else {
                // -1时返回首页
                if (pages.length > 1 &amp;&amp; argType !== '-1') {
                    app.navigateBack({
                        delta: +argType || 1,
                    });
                }
                else {
                    app.reLaunch({
                        url: '/pages/index/index' + setUrlParams(argParams),
                    });
                }
            }
            return;
        }
        // 每次进入首页都重载
        if (argPage === 'index' || argPage === '/pages/index/index') {
            app.reLaunch({
                url: '/pages/' + argPage + '/index' + setUrlParams(argParams),
            });
            return;
        }
        let temUrl = '/pages/' + argPage + '/index' + setUrlParams(argParams);
        // 匹配绝对路径和url
        if (argPage[0] === '/' || /http:\/\/|https:\/\//.test(argPage)) {
            temUrl = argPage + setUrlParams(argParams);
        }
        if (isH5 &amp;&amp; /http:\/\/|https:\/\//.test(argPage)) {
            temUrl = argPage + setUrlParams(argParams);
            window.location.replace(temUrl);
            return;
        }
        switch (argType) {
            case 'switchTab':
                app.switchTab({
                    url: temUrl,
                });
                break;
            case 'reload':
                app.reLaunch({
                    url: temUrl,
                });
                break;
            case 'redirectTo':
                if (isH5) {
                    window.location.replace('#' + temUrl);
                }
                else {
                    app.redirectTo({
                        url: temUrl,
                    });
                }
                break;
            case 'reLaunch':
                app.reLaunch({
                    url: temUrl,
                });
                break;
            default:
                // 超10层处理
                if (!isH5 &amp;&amp; pages.length >= 10) {
                    app.redirectTo({
                        url: temUrl,
                    });
                    return;
                }
                app.navigateTo &amp;&amp;
                    app.navigateTo({
                        url: temUrl,
                    });
                break;
        }
    };
    if (isH5 || argForce) {
        toPageFn();
    }
    else {
        throttle.throttle(toPageFn);
    }
};
/**
 * @function
 * @description 获取当前页面数据obj
 * @returns {object}
 */
export const getCurrentPage = () => {
    let pages = (typeof getCurrentPages !== 'undefined' &amp;&amp; getCurrentPages()) || [];
    return pages[pages.length - 1] || {};
};
/**
 * @function
 * @description 获取当前页url
 * @param {boolean} argWithParams 是否附带参数
 * @returns {string}
 */
export const getCurrentPageUrl = (argWithParams = true) => {
    let currentPage = getCurrentPage();
    let url = currentPage.route || '';
    let options = currentPage.options || {};
    if (argWithParams) {
        url += setUrlParams(options);
    }
    return url || '';
};
/**
 * @function
 * @description 获取微信登录code
 * @returns {promise}
 */
export const login = () => {
    return new Promise(function (resolve, reject) {
        app.login({
            timeout: 5000,
            success: function (rs) {
                app.setStorageSync('code', rs.code);
                console.debug('micro login info:', rs);
                return resolve(rs);
            },
            fail: function (err) {
                toast('请检查网络');
                return reject(err);
            },
        });
    });
};
/**
 * @function
 * @description 获取用户信息
 * @param {object} argData 用户数据（点按钮授权时传入）
 * @returns {promise}
 */
export function getUserInfo(argData) {
    return __awaiter(this, void 0, void 0, function* () {
        L.loading(1);
        const _login = yield login().catch((err) => {
            console.error(err);
            L.loading();
        });
        const setUserInfo = (argData) => {
            L.loading();
            return argData;
        };
        if (argData) {
            if (argData.target) {
                argData.target.code = _login.code;
            }
            return setUserInfo(argData.target);
        }
        else {
            const _checkSetting = yield checkSetting('userInfo').catch((err) => {
                console.error('unAuthor', err);
                L.loading();
            });
            _checkSetting.code = _login.code;
            return setUserInfo(_checkSetting);
        }
    });
}
/**
 * @function
 * @description 下载图片到手机
 * @param {array} argImgList 图片url,数组或字符串
 * @param {boolean} argIsLocal 是否是本地临时文件路径或永久文件路径
 * @returns {promise} 出错时无promise
 */
export const downloadImgs = (argImgList, argIsLocal = false) => __awaiter(void 0, void 0, void 0, function* () {
    let isAuth = true;
    let res = null;
    let imgList = [];
    if (argImgList &amp;&amp; typeof argImgList === 'string') {
        imgList = [argImgList];
    }
    imgList = argImgList;
    if (!imgList.length) {
        console.error('参数有误！');
        return Promise.reject(false);
    }
    L.loading(1);
    yield checkSetting('writePhotosAlbum').catch((err) => {
        console.error('writePhotosAlbum error:', err);
        isAuth = false;
        L.loading();
    });
    // 拒绝授权处理
    if (!isAuth) {
        res = yield P('showModal', {
            title: '提示',
            content: '需要您授权保存相册',
            showCancel: false,
            success() {
                return __awaiter(this, void 0, void 0, function* () {
                    const res = yield P('openSetting');
                    if (res.authSetting['scope.writePhotosAlbum']) {
                        app.showModal({
                            title: '提示',
                            content: '已获得权限，请重新操作！',
                            showCancel: false,
                        });
                        return true;
                    }
                    else {
                        app.showModal({
                            title: '提示',
                            content: '未获得权限，将无法保存到相册哦~',
                            showCancel: false,
                        });
                        return false;
                    }
                });
            },
        });
    }
    for (const img of imgList) {
        let tempFilePath = img;
        if (!argIsLocal) {
            res = yield P('downloadFile', {
                url: img,
            });
            tempFilePath = res.tempFilePath;
        }
        let saveFail = false;
        yield P('saveImageToPhotosAlbum', {
            filePath: tempFilePath,
        }).catch((err) => {
            saveFail = true;
            console.error('saveImageToPhotosAlbum error:', err);
        });
        if (saveFail) {
            L.loading();
            toast('保存到相册失败，请重试！');
            return Promise.reject(false);
        }
    }
    L.loading();
    toast('下载完成！');
    return Promise.resolve(true);
});
/**
 * @function
 * @description 上传图片，返回临时图片路径
 * @param {object} argOptions
 * argOptions.count: 9,最多可以选择的图片张数
 * argOptions.sizeType: ['original', 'compressed'], 所选的图片的尺寸
 * argOptions.sourceType: ['album', 'camera'] album ,从相册选图，camera 使用相机，默认二者都有。如需直接开相机或直接选相册，请只使用一个选项
 * argOptions.disCompress: false 是否关闭图片压缩，默认开启
 * } 外加选择图片chooseImage配置
 * @param {number} argMb 超过多少M压缩，默认1M(仅支持jpg)
 * @param {number} argQuality 压缩质量默认80
 * @param {number} argMaxSize 图片最长边默认1920
 * @returns {promise} 返回临时图片路径[{tempFilePath:'临时路径',size: '不压缩时返回'}]
 */
export const uploadImgs = (argOptions = {
    // 最多可以选择的图片张数
    count: 9,
    // 所选的图片的尺寸
    sizeType: ['original', 'compressed'],
    // album 从相册选图，camera 使用相机，默认二者都有。如需直接开相机或直接选相册，请只使用一个选项
    sourceType: ['album', 'camera'],
    // 是否关闭图片压缩，默认开启
    disCompress: false,
    // reType:'base64'
}, argMb = 1, argQuality = 90, argMaxSize = 1920) => __awaiter(void 0, void 0, void 0, function* () {
    var maxSize = argMaxSize || 1920;
    let err = '';
    const res = yield P('chooseImage', {
        count: argOptions.count || 9,
        sizeType: argOptions.sizeType || ['original', 'compressed'],
        sourceType: argOptions.sourceType || ['album', 'camera'],
    }).catch((error) => {
        err = error;
    });
    if (!res) {
        console.error('chooseImage error:', err);
        return Promise.reject(err);
    }
    console.debug('select files：', res);
    showLoading();
    // 按需压缩
    const tempFiles = res.tempFiles;
    // 压缩图片
    const compressImage = (argData) => __awaiter(void 0, void 0, void 0, function* () {
        if (argData.size > argMb * 1024 * 1024) {
            console.debug('compressImage params：', argData);
            if (!isH5 &amp;&amp; !argOptions.disCompress) {
                return P('compressImage', {
                    src: argData.path,
                    quality: argQuality,
                });
            }
            const getBase64Image = (argData) => __awaiter(void 0, void 0, void 0, function* () {
                if (argData &amp;&amp; argData.img) {
                    return { path: null, file: null };
                }
                console.debug('canvas compress start');
                var canvas = document.createElement('canvas');
                var img = argData.img;
                let scaleRate;
                if (img.width > img.height &amp;&amp; img.width > maxSize) {
                    scaleRate = img.width / maxSize;
                    img.width = maxSize;
                    img.height = img.height / scaleRate;
                }
                if (img.height > img.width &amp;&amp; img.height > maxSize) {
                    scaleRate = img.height / maxSize;
                    img.height = maxSize;
                    img.width = img.width / scaleRate;
                }
                canvas.width = img.width;
                canvas.height = img.height;
                var ctx = canvas.getContext('2d');
                ctx &amp;&amp; ctx.drawImage(img, 0, 0, img.width, img.height);
                let rate = argQuality / 100;
                // base64Url
                var base64Url = canvas.toDataURL('image/jpeg', rate);
                if (argOptions.reType === 'base64') {
                    return {
                        path: base64Url,
                        file: null,
                    };
                }
                else {
                    let blob = dataURLtoBlob(base64Url);
                    var file = blobToFile(blob, argData.name);
                    console.debug('old:', argData.size / 1024, 'new:', base64Url.length / 1024, 'fileSize:', file.size / 1024, file, typeof file);
                    return {
                        path: base64Url,
                        file: file,
                    };
                }
            });
            const loadImg = (argData) => __awaiter(void 0, void 0, void 0, function* () {
                return new Promise((resolve, reject) => {
                    var img = new Image();
                    img.src = argData.path;
                    img.onload = function () {
                        return resolve({
                            img,
                            name: argData.name || '',
                        });
                    };
                    img.onerror = function (error) {
                        return reject(error);
                    };
                });
            });
            let file = yield getBase64Image(yield loadImg(argData));
            if (safeData(file, 'file.size') > argMb * 1024 * 1024) {
                console.debug('二次压缩', file);
                // 控制质量
                argQuality = argQuality / 2;
                file = yield getBase64Image(yield loadImg(file));
            }
            return Promise.resolve({
                // 临时路径
                tempFilePath: file.path,
                file: file.file,
                fileName: argData.name || '',
                // 大小
                size: safeData(file, 'file.size', null),
            });
        }
        return Promise.resolve({
            tempFilePath: argData.path,
            size: argData.size,
            fileName: argData.name || '',
            file: argData,
        });
    });
    const tempFilePathsFn = tempFiles.map(compressImage);
    let tempFilePaths = [];
    tempFilePaths = yield Promise.all(tempFilePathsFn).catch((error) => {
        console.error('compressImage error:', error);
        err = error;
    });
    hideLoading();
    if (!tempFilePaths) {
        return Promise.reject(err);
    }
    return Promise.resolve(tempFilePaths);
});
/**
 * @function
 * @description 检测浏览器状态，系统状态 *
 * @returns {object} {
 * ua: ua,
 * platform: 平台,
 * isMobile: 移动端,
 * isWin: winPC端,
 * isIphone: iphone,
 * isIpad: ipad,
 * isMac: mac,
 * isAppleMobile: 苹果移动端webview
 * isSafari: Safari浏览器,
 * isIos: Ios平台,
 * isAndroid: android平台,
 * isIE: 显示8 9 10, true为11以上
 * ...
 * }
 */
export const getSystemInfo = () => {
    if (typeof app === 'object' &amp;&amp; safeData(app, 'getSystemInfoSync')) {
        let info = app.getSystemInfoSync();
        let defInfo = getInfo();
        defInfo.platform = info.platform || defInfo.platform;
        info.iosVersion =
            info.isIos &amp;&amp; info.system.match(/\d./) &amp;&amp; info.system.match(/\d./)[0];
        return Object.assign(info, defInfo);
    }
    return getInfo();
};
/**
 * @function
 * @description 获取storage的值，默认将json转为obj
 * @param {string} argKey 要获取的key
 * @param {boolean} argNoJson true时不自动转换JSON字符串
 * @returns {promise} key对应的数据
 */
export const getStorage = (argKey, argNoJson = false) => __awaiter(void 0, void 0, void 0, function* () {
    let res = yield P('getStorage', {
        key: argKey,
    });
    if (appConfig.localEncrypt) {
        res = decode(res.data);
    }
    if (!res || !res.data) {
    }
    // 默认转义JSON字符串
    if (!argNoJson &amp;&amp; isJson(res.data)) {
        res.data = JSON.parse(res.data);
    }
    return res.data || res || '';
});
/**
 * @function
 * @description 获取storage的值，默认将json转为obj
 * @param {string} argKey 要获取的key
 * @param {boolean} argNoJson true时不自动转换JSON字符串
 * @returns {any} key对应的数据
 */
export const getStorageSync = (argKey, argNoJson = false) => {
    let data = app.getStorageSync(argKey);
    if (appConfig.localEncrypt) {
        data = decode(data);
    }
    // 默认转义JSON字符串
    if (!argNoJson &amp;&amp; isJson(data)) {
        data = JSON.parse(data);
    }
    return data;
};
/**
 * @function
 * @description 退出登录或登录失效，清除本地数据
 * @param {string} argKey 要删除的key,不填为删除全部
 * @param {string} argExtraKey:额外保留的key如：'vuex,ticket'
 * @param {boolean} isForce 是否强制删除全部
 */
export const clearStorageSync = (argKey = '', argExtraKey = '', isForce = false) => __awaiter(void 0, void 0, void 0, function* () {
    if (argKey) {
        app.removeStorageSync(argKey);
    }
    else if (isForce) {
        app.clearStorageSync();
    }
    else {
        let res = yield P('getStorageInfo');
        res.keys.forEach((v) => {
            if (!isForce) {
                let extraKey = ',' + argExtraKey + ',';
                if (extraKey.match(',' + v + ',')) {
                    return;
                }
            }
            app.removeStorageSync(v);
        });
    }
});
/**
 * @function
 * @description 设置storage的值，默认将obj转为json
 * @param {string} argKey 要设置的key
 * @param {string|AnyObject} argData 要设置的值
 * @returns {promise} key对应的数据
 */
export const setStorage = (argKey, argData) => __awaiter(void 0, void 0, void 0, function* () {
    let temData = argData;
    if (appConfig.localEncrypt) {
        if (typeof argData === 'object') {
            argData = JSON.stringify(argData);
        }
        temData = encode(argData);
    }
    const res = yield P('setStorage', {
        key: argKey,
        data: temData,
    }).catch((err) => {
        console.error('setStorage', err);
    });
    return res.data || res || '';
});
/**
 * @function
 * @description wx/taro/uni api转Promise
 * @param {string} argApi 需要转promise的API名称
 * @param {object} argOptions {} api对应的配置，除了success和fail
 * @returns {promise}
 */
export const P = (argApi, argOptions = {}) => {
    return new Promise(function (resolve, reject) {
        if (!argApi &amp;&amp; argOptions.success) {
            return argOptions.success(resolve, reject);
        }
        const options = {
            success: resolve,
            fail: reject,
        };
        Object.assign(options, argOptions);
        if (app[argApi]) {
            app[argApi](options);
        }
        else {
            return reject('无此方法');
        }
    });
};
/**
 * 描述
 * @function
 * @description 微信实时日志记录
 * @date 2019-09-26
 * @returns {AnyObject}
 */
export const wxLog = () => {
    // logLevel 1 error 2 warn 3 info 4 debug
    const logLevel = +getStorageSync('logLevel');
    switch (logLevel) {
        case 1:
            console.warn = () => { };
        // eslint-disable-next-line no-fallthrough
        case 2:
            console.info = () => { };
        // eslint-disable-next-line no-fallthrough
        case 3:
            console.log = () => { };
        // eslint-disable-next-line no-fallthrough
        case 4:
        case 0:
        default:
            break;
    }
    if (!wx) {
        return {};
    }
    let log = null;
    if (wx) {
        log = wx.getRealtimeLogManager ? wx.getRealtimeLogManager() : null;
    }
    return {
        debug() {
            if (!log)
                return;
            log.debug.apply(log, arguments);
        },
        info() {
            if (!log)
                return;
            log.info.apply(log, arguments);
        },
        warn() {
            if (!log)
                return;
            log.warn.apply(log, arguments);
        },
        error() {
            if (!log)
                return;
            log.error.apply(log, arguments);
        },
        setFilterMsg(msg) {
            // 从基础库2.7.3开始支持
            if (!log || !log.setFilterMsg)
                return;
            if (typeof msg !== 'string')
                return;
            log.setFilterMsg(msg);
        },
        addFilterMsg(msg) {
            // 从基础库2.8.1开始支持
            if (!log || !log.addFilterMsg)
                return;
            if (typeof msg !== 'string')
                return;
            log.addFilterMsg(msg);
        },
    };
};
/**
 * 描述
 * @function
 * @description 小程序云函数调用
 * @param {string} argOption 云函数配置
 * @date 2019-09-26
 * @returns {promise}
 */
export const cloudApi = (argOption = {}) => __awaiter(void 0, void 0, void 0, function* () {
    if (wx) {
        L.loading(1);
        let error = '';
        const res = yield wx.cloud.callFunction(argOption).catch((err) => {
            toast(`云函数:${argOption.name}调用失败！`);
            error = err;
        });
        L.loading();
        if (error) {
            return Promise.reject(error);
        }
        return Promise.resolve(res);
    }
    else {
        return Promise.reject('暂不支持');
    }
});
/**
 * @function
 * @description 富文本格式处理 for 小程序rich-text
 * @param {string} argData 富文本
 * @returns {string}
 */
export const getRichText = (argData) => {
    if (!argData) {
        return '';
    }
    const imgReg = /&lt;img.*?(?:>|\/>)/gi;
    const styleReg = /style="([^"]*)"/g;
    // 处理空格
    argData = argData.replace(/&amp;nbsp;/g, '\xa0');
    argData = String(argData).replace(imgReg, (match) => {
        let newStyleImg = '';
        // 图片样式保留原来style添加大小限制，若原来img没有设style则直接插进去
        if (!match.match('max-width:100%')) {
            let temStyle = safeData(match.match(styleReg), '0', '');
            if (temStyle) {
                temStyle =
                    temStyle.slice(0, temStyle.length - 1) +
                        ';max-width:100%;height:auto;"';
                newStyleImg = match.replace(styleReg, temStyle);
            }
            else {
                newStyleImg = match.replace(/&lt;img/gim, '&lt;img style="max-width:100%;height:auto;"');
            }
        }
        else {
            newStyleImg = match;
        }
        // #ifdef MP
        // newStyleImg = newStyleImg.replace(/px;/gim, 'rpx;')
        // #endif
        return newStyleImg;
    });
    return argData;
};
/**
 * @function
 * @description 页面刷新
 */
export const refresh = () => {
    let nowPage = getCurrentPage();
    let options = getUrlParamObj(safeData(nowPage, '$page.fullPath'));
    nowPage.onLoad &amp;&amp; nowPage.onLoad(options);
    nowPage.onReady &amp;&amp; nowPage.onReady();
    nowPage.onShow &amp;&amp; nowPage.onShow();
};
/**
 * @function
 * @description: 获取dom节点相关信息
 * @param {object}  argThis: 当前this,
 * @param {string} argId id/class
 * @param {Boolean} getAll 是否获取全部 true时，返回数组
 * @param {object} argOptions 修改默认返回具体参考：https://uniapp.dcloud.io/api/ui/nodes-info?id=nodesreffields
 * @return: object/array
 */
export const getDom = (argThis, argId, getAll = false, argOptions) => __awaiter(void 0, void 0, void 0, function* () {
    let temOptions = {
        id: true,
        dataset: true,
        rect: true,
        size: true,
        scrollOffset: true,
        computedStyle: [],
        context: true,
        properties: [],
    };
    if (isH5) {
        delete temOptions.properties;
    }
    if (argOptions) {
        Object.assign(temOptions, argOptions);
    }
    return new Promise((resolve, rejects) => {
        let nodesRef;
        let temDom = uni.createSelectorQuery().in(argThis);
        nodesRef = temDom[getAll ? 'selectAll' : 'select'](argId);
        nodesRef
            .fields(temOptions, (res) => {
            if (getAll &amp;&amp; Array.isArray(res) &amp;&amp; res.length) {
                resolve(res);
            }
            if (!getAll &amp;&amp; res) {
                resolve(res);
            }
            rejects(res);
        })
            .exec();
    });
});
/**
 * @description APP:返回 uni/wx/taro实例
 * @constant {object}
 */
export const APP = app;
/**
 * @description IS_H5:是否为H5
 * @constant {boolean}
 * @default false
 */
export const IS_H5 = isH5;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Wed May 31 2023 07:50:38 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



    <script src="scripts/baidu.js"></script>
    
    <script src="https://npm.elemecdn.com/lj-utils/index.umd.js"></script>
    
</body>
</html>
