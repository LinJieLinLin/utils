<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>base.js - lj-utils</title>
    
    <meta name="description" content="A clean, responsive documentation template theme for JSDoc 3." />
    
        <meta name="keywords" content="jsdoc, docdash,lj-utils" />
        <meta name="keyword" content="jsdoc, docdash,lj-utils" />
    
    
    
    <meta property="og:title" content="Docdash"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://cloud.githubusercontent.com/assets/447956/13398144/4dde7f36-defd-11e5-8909-1a9013302cb9.png"/>
    <meta property="og:site_name" content="Docdash"/>
    <meta property="og:url" content="http://clenemt.github.io/docdash/"/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://github.com/LinJieLinLin/utils" target="_blank" class="menu-item" id="Github" >Github repo</a></h2><h2><a href="https://gitee.com/uni-pro/utils" target="_blank" class="menu-item" id="Gitee" >Gitee repo</a></h2><h2><a href="../coverage/index.html" target="_blank" class="menu-item" id="coverage" >coverage</a></h2><h3>Classes</h3><ul><li><a href="CanvasClass.html">CanvasClass</a><ul class='methods'><li data-type='method'><a href="CanvasClass.html#draw">draw</a></li><li data-type='method'><a href="CanvasClass.html#getScale">getScale</a></li></ul></li><li><a href="Counter.html">Counter</a><ul class='methods'><li data-type='method'><a href="Counter.html#setCount">setCount</a></li><li data-type='method'><a href="Counter.html#setMaxCount">setMaxCount</a></li><li data-type='method'><a href="Counter.html#start">start</a></li><li data-type='method'><a href="Counter.html#stop">stop</a></li></ul></li><li><a href="Debounce.html">Debounce</a><ul class='methods'><li data-type='method'><a href="Debounce.html#debounce">debounce</a></li></ul></li><li><a href="Loading.html">Loading</a><ul class='methods'><li data-type='method'><a href="Loading.html#loading">loading</a></li></ul></li><li><a href="Throttle.html">Throttle</a><ul class='methods'><li data-type='method'><a href="Throttle.html#throttle">throttle</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-encrypt_base64.html">encrypt/base64</a><ul class='methods'><li data-type='method'><a href="module-encrypt_base64.html#.deBase64">deBase64</a></li><li data-type='method'><a href="module-encrypt_base64.html#.decode">decode</a></li><li data-type='method'><a href="module-encrypt_base64.html#.enBase64">enBase64</a></li><li data-type='method'><a href="module-encrypt_base64.html#.encode">encode</a></li></ul></li><li><a href="module-encrypt_crypto.html">encrypt/crypto</a><ul class='methods'><li data-type='method'><a href="module-encrypt_crypto.html#.aesInit">aesInit</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.deAes">deAes</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.deBase64">deBase64</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.decode">decode</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.enAes">enAes</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.enBase64">enBase64</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.encode">encode</a></li><li data-type='method'><a href="module-encrypt_crypto.html#.md5">md5</a></li></ul></li><li><a href="module-index.html">index</a><ul class='methods'><li data-type='method'><a href="module-index.html#.blobToBase64">blobToBase64</a></li><li data-type='method'><a href="module-index.html#.blobToFile">blobToFile</a></li><li data-type='method'><a href="module-index.html#.blobUrlToFile">blobUrlToFile</a></li><li data-type='method'><a href="module-index.html#.dataURLtoBlob">dataURLtoBlob</a></li><li data-type='method'><a href="module-index.html#.decodeHtml">decodeHtml</a></li><li data-type='method'><a href="module-index.html#.delCookie">delCookie</a></li><li data-type='method'><a href="module-index.html#.dlFile">dlFile</a></li><li data-type='method'><a href="module-index.html#.encodeHtml">encodeHtml</a></li><li data-type='method'><a href="module-index.html#.formatNumber">formatNumber</a></li><li data-type='method'><a href="module-index.html#.formatSize">formatSize</a></li><li data-type='method'><a href="module-index.html#.formatTime">formatTime</a></li><li data-type='method'><a href="module-index.html#.friendlyTime">friendlyTime</a></li><li data-type='method'><a href="module-index.html#.getCookie">getCookie</a></li><li data-type='method'><a href="module-index.html#.getDuration">getDuration</a></li><li data-type='method'><a href="module-index.html#.getEnv">getEnv</a></li><li data-type='method'><a href="module-index.html#.getInfo">getInfo</a></li><li data-type='method'><a href="module-index.html#.getNetworkStatus">getNetworkStatus</a></li><li data-type='method'><a href="module-index.html#.getRandomColor">getRandomColor</a></li><li data-type='method'><a href="module-index.html#.getRegexp">getRegexp</a></li><li data-type='method'><a href="module-index.html#.getStorage">getStorage</a></li><li data-type='method'><a href="module-index.html#.getUrlParam">getUrlParam</a></li><li data-type='method'><a href="module-index.html#.getUrlParamObj">getUrlParamObj</a></li><li data-type='method'><a href="module-index.html#.getUuid">getUuid</a></li><li data-type='method'><a href="module-index.html#.hideInfo">hideInfo</a></li><li data-type='method'><a href="module-index.html#.isBlob">isBlob</a></li><li data-type='method'><a href="module-index.html#.isFile">isFile</a></li><li data-type='method'><a href="module-index.html#.isIdCard">isIdCard</a></li><li data-type='method'><a href="module-index.html#.isJson">isJson</a></li><li data-type='method'><a href="module-index.html#.isPrime">isPrime</a></li><li data-type='method'><a href="module-index.html#.loadFile">loadFile</a></li><li data-type='method'><a href="module-index.html#.px2vw">px2vw</a></li><li data-type='method'><a href="module-index.html#.randomInt">randomInt</a></li><li data-type='method'><a href="module-index.html#.remInit">remInit</a></li><li data-type='method'><a href="module-index.html#.replaceUrlParam">replaceUrlParam</a></li><li data-type='method'><a href="module-index.html#.rmbPrice">rmbPrice</a></li><li data-type='method'><a href="module-index.html#.safeData">safeData</a></li><li data-type='method'><a href="module-index.html#.secondToTime">secondToTime</a></li><li data-type='method'><a href="module-index.html#.setCookie">setCookie</a></li><li data-type='method'><a href="module-index.html#.setEnv">setEnv</a></li><li data-type='method'><a href="module-index.html#.setStorage">setStorage</a></li><li data-type='method'><a href="module-index.html#.setTitle">setTitle</a></li><li data-type='method'><a href="module-index.html#.setUrlParams">setUrlParams</a></li><li data-type='method'><a href="module-index.html#.sleep">sleep</a></li><li data-type='method'><a href="module-index.html#.string10to62">string10to62</a></li><li data-type='method'><a href="module-index.html#.string62to10">string62to10</a></li><li data-type='method'><a href="module-index.html#.toFixed">toFixed</a></li><li data-type='method'><a href="module-index.html#.toHump">toHump</a></li><li data-type='method'><a href="module-index.html#.toLine">toLine</a></li></ul></li><li></li><li></li><li></li><li></li><li><a href="module-microApi.html">microApi</a><ul class='methods'><li data-type='method'><a href="module-microApi.html#.checkSetting">checkSetting</a></li><li data-type='method'><a href="module-microApi.html#.checkUpdate">checkUpdate</a></li><li data-type='method'><a href="module-microApi.html#.clearStorageSync">clearStorageSync</a></li><li data-type='method'><a href="module-microApi.html#.cloudApi">cloudApi</a></li><li data-type='method'><a href="module-microApi.html#.downloadImgs">downloadImgs</a></li><li data-type='method'><a href="module-microApi.html#.getCurrentPage">getCurrentPage</a></li><li data-type='method'><a href="module-microApi.html#.getCurrentPageUrl">getCurrentPageUrl</a></li><li data-type='method'><a href="module-microApi.html#.getDb">getDb</a></li><li data-type='method'><a href="module-microApi.html#.getLocation">getLocation</a></li><li data-type='method'><a href="module-microApi.html#.getRichText">getRichText</a></li><li data-type='method'><a href="module-microApi.html#.getStorage">getStorage</a></li><li data-type='method'><a href="module-microApi.html#.getStorageSync">getStorageSync</a></li><li data-type='method'><a href="module-microApi.html#.getSystemInfo">getSystemInfo</a></li><li data-type='method'><a href="module-microApi.html#.getUserInfo">getUserInfo</a></li><li data-type='method'><a href="module-microApi.html#.hideLoading">hideLoading</a></li><li data-type='method'><a href="module-microApi.html#.init">init</a></li><li data-type='method'><a href="module-microApi.html#.ljApiFn">ljApiFn</a></li><li data-type='method'><a href="module-microApi.html#.ljLog">ljLog</a></li><li data-type='method'><a href="module-microApi.html#.login">login</a></li><li data-type='method'><a href="module-microApi.html#.P">P</a></li><li data-type='method'><a href="module-microApi.html#.refresh">refresh</a></li><li data-type='method'><a href="module-microApi.html#.request">request</a></li><li data-type='method'><a href="module-microApi.html#.requestCloud">requestCloud</a></li><li data-type='method'><a href="module-microApi.html#.scrollTop">scrollTop</a></li><li data-type='method'><a href="module-microApi.html#.setRequest">setRequest</a></li><li data-type='method'><a href="module-microApi.html#.setStorage">setStorage</a></li><li data-type='method'><a href="module-microApi.html#.setTitle">setTitle</a></li><li data-type='method'><a href="module-microApi.html#.showLoading">showLoading</a></li><li data-type='method'><a href="module-microApi.html#.toast">toast</a></li><li data-type='method'><a href="module-microApi.html#.toPage">toPage</a></li><li data-type='method'><a href="module-microApi.html#.uploadImg">uploadImg</a></li><li data-type='method'><a href="module-microApi.html#.uploadImgs">uploadImgs</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">base.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { safeData } from './data';
import { isJson } from './is';
/**
 * @module index
 * @author linj
 * @description 公共函数，使用'lj-utils'引入
 */
let isOnline = true;
// #ifdef H5
// 断网监听
if (globalThis &amp;&amp; globalThis.addEventListener) {
    globalThis.addEventListener('offline', function () {
        // console.log('offLine')
        isOnline = false;
    });
    globalThis.addEventListener('online', function () {
        // console.log('onLine')
        isOnline = true;
    });
}
// #endif
/**
 * @function
 * @description 获取当前网络状态（H5）
 * @return boolean
 */
export const getNetworkStatus = () => {
    return isOnline;
};
/**
 * @function
 * @description 正则收集
 * @returns {object}
 */
export const getRegexp = () => {
    return {
        // 匹配html标签，提取html文字： htmlCode.replace(reg.html,'')
        html: /&lt;[^>]+>/gim,
        // 至少1数字1字母1字符，8-16位
        password: /^(?=.*?[A-Za-z])(?=.*?[0-9])(?=.*?[\W_]).{8,16}$/,
        // 普通身份证号正则，isIdCard更为严格
        idCard: /^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/,
        // 简易身份证号 数字+x
        idCardNormal: /^[0-9]\d+([0-9]|X|x)*$/,
        // 手机号
        phone: /^1\d{10}$/,
        // 邮箱
        email: /^(w)+(.w+)*@(w)+((.w+)+)$/,
        // 网址
        http: /http:\/\/|https:\/\//,
        // 含0整数（得分）
        score: /^[1-9]\d*|0$/,
        // 整数
        int: /^[1-9]\d*$/,
        // 匹配数字
        number: /^\d*$/,
        // >=0||1位小数
        float1: /^(([1-9]\d*)|0|(0.\d{0,1})|([1-9]\d*.\d{0,1}))$/,
        // >=0||2位小数
        float2: /^(([1-9]\d*)|0|(0.\d{0,2})|([1-9]\d*.\d{0,2}))$/,
        // >=0||3位小数
        float3: /^(([1-9]\d*)|0|(0.\d{0,3})|([1-9]\d*.\d{0,3}))$/,
        // 字母+数字组合
        letterNumber: /^[a-zA-Z0-9]*$/,
        // 字母
        letter: /^[a-zA-Z]*$/,
        // 帐号50个字内：大小写+数字+中文+'_'+'-'
        account: /^[a-zA-Z0-9_\-\u4e00-\u9fa5]{1,50}$/,
        // 中英文姓名 50个字内/中文 中文/英文-. 英文-./
        realName: /^([\u4e00-\u9fa5]{1,50}|[\u4e00-\u9fa5]{1,25}[\s][\u4e00-\u9fa5]{1,24}|[a-zA-Z_\-.]{1,50}|[a-zA-Z_\-.]{1,25}[\s][a-zA-Z_\-.]{1,24})$/,
        // 匹配中文
        cn: /^[\u4e00-\u9fa5]*$/,
    };
};
/**
 * @function
 * @description 设置标题
 * @param  {string} argTitle 标题
 */
export const setTitle = (argTitle) => {
    if (safeData(globalThis.document.getElementsByTagName('title'), '0.innerText')) {
        globalThis.document.getElementsByTagName('title')[0].innerText =
            String(argTitle);
    }
    if (getInfo().isAppleMobile) {
        var i = document.createElement('iframe');
        i.onload = function () {
            setTimeout(function () {
                console.log('ios set title');
                i.remove();
            }, 10);
        };
        globalThis.document.body.appendChild(i);
    }
};
/**
 * @function
 * @description 使用postcss-px2rem时使用
 * @param {number} argBaseSize 基础大小 16px（要跟配置一致）
 * @param {number} argWidth 基准宽度
 */
export const remInit = (argBaseSize = 16, argWidth = 375) => {
    // 设置 rem 函数
    const setRem = () => {
        // 当前页面宽度相对于 argWidth 宽的缩放比例，可根据自己需要修改。
        const scale = safeData(globalThis, 'document.documentElement.clientWidth', argWidth) /
            argWidth;
        // 设置页面根节点字体大小
        safeData(globalThis, 'document.documentElement.style.fontSize', argBaseSize * scale + 'px', true);
    };
    // 初始化
    setRem();
    // 改变窗口大小时重新设置 rem
    globalThis.onresize = () => {
        setRem();
    };
};
/**
 * @function
 * @description 获取cookie
 * @param  {string} argName 要获取的值
 * @returns {string}
 */
export const getCookie = (argName) => {
    let cookie = globalThis.document.cookie.split('; ');
    for (let i = 0; i &lt; cookie.length; i += 1) {
        let name = ('' + cookie[i]).split('=');
        if (argName === name[0]) {
            return decodeURIComponent(name[1] || '');
        }
    }
    return '';
};
/**
 * @function
 * @description 设置cookie
 * @param  {string} argName 要设置的key
 * @param  {string} argValue 要设置的value
 * @param  {number} argTime 过期时间/时 默认24小时
 */
export const setCookie = (argName, argValue = '', argTime = 24) => {
    let now = new Date();
    let offset = 8;
    let utc = now.getTime() + now.getTimezoneOffset() * 60000;
    let nd = utc + 3600000 * offset;
    let exp = new Date(nd);
    let domain = globalThis.document.domain;
    exp.setTime(exp.getTime() + argTime * 60 * 60 * 1000);
    globalThis.document.cookie =
        argName +
            '=' +
            encodeURIComponent(argValue) +
            ';path=/;expires=' +
            exp.toUTCString() +
            ';domain=' +
            domain +
            ';';
};
/**
 * @function
 * @description 清除cookie
 * @param  {string} argName 要清除的值
 */
export const delCookie = (argName = '') => {
    setCookie(argName, '', -1);
};
/**
 * @function
 * @description 检测浏览器状态，系统状态 *
 * @returns {Info} {
 * ua: ua,
 * platform: 平台,
 * isMobile: 移动端,
 * isWin: winPC端,
 * isIphone: iphone,
 * isIpad: ipad,
 * isMac: mac,
 * isAppleMobile: 苹果移动端webview
 * isSafari: Safari浏览器,
 * isIos: Ios平台,
 * isAndroid: android平台,
 * isIE: 显示8 9 10, true为11以上
 * ...
 * }
 */
export const getInfo = () => {
    let ua = safeData(globalThis, 'navigator.userAgent', '').toLowerCase();
    let platform = safeData(globalThis, 'navigator.userAgentData.platform', '').toLowerCase();
    let info = {
        ua: ua,
        platform: platform,
        isMobile: !!ua.match(/mobile/),
        isWin: !!platform.match('win'),
        isIphone: !!ua.match(/iphone/),
        isIpad: !!ua.match(/ipad/),
        isMac: !!platform.match('mac'),
        isIos: !!platform.match('ios'),
        isAndroid: !!platform.match('android'),
        isSafari: ua.indexOf('safari') > -1 &amp;&amp; ua.indexOf('chrome') &lt; 1,
        isIE: 'ActiveXObject' in globalThis,
        ieVersion: 0,
        isAppleMobile: false,
        isWeixin: !!ua.match(/MicroMessenger/i),
        isAlipay: !!ua.match(/Alipay/i),
    };
    if (info.ua.match('msie')) {
        let IE = info.ua.match(/msie\s([0-9]*)/);
        if (IE &amp;&amp; IE.length >= 2) {
            info.ieVersion = +IE[1];
        }
    }
    info.isAppleMobile = !!(info.isMobile &amp;&amp;
        ua.toLowerCase().indexOf('applewebkit') &amp;&amp;
        ua.indexOf('chrome') &lt; 1);
    return info;
};
/**
 * @function
 * @description 获取随机颜色
 * @return string
 */
export const getRandomColor = function () {
    return ('#' +
        ('00000' + ((Math.random() * 0x1000000) &lt;&lt; 0).toString(16)).substring(-6));
};
/**
 * @function
 * @description 获取storage的值，默认将json转为obj
 * @param {string} argKey 要获取的key
 * @param {string} argNoJson true时不自动转换JSON字符串
 * @returns {any} key对应的数据
 */
export const getStorage = (argKey, argNoJson) => {
    let res = globalThis.localStorage.getItem(argKey);
    // 默认转义JSON字符串
    if (!argNoJson &amp;&amp; isJson(res) &amp;&amp; res) {
        res = JSON.parse(res);
    }
    return res || '';
};
/**
 * @function
 * @description 设置storage的值，默认将obj转为json
 * @param {string} argKey 要获取的key
 * @param {unknown} argData 要保存的数据
 * @returns {string} 保存的数据String
 */
export const setStorage = (argKey, argData) => {
    if (typeof argData === 'object') {
        argData = JSON.stringify(argData);
    }
    globalThis.localStorage.setItem(argKey, String(argData));
    return String(argData);
};
/**
 * @function
 * @description setTimeout promise版
 * @param  {number} ms 时间，毫秒
 */
export const sleep = (ms) => {
    return new Promise((resolve) => setTimeout(resolve, ms));
};
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Sat Apr 16 2022 15:16:23 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
